{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\Script\\hall/assets\\Script\\hall\\rolePanel.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\..\\assets\\Script\\hall","sourcesContent":["import { playerRes } from \"../game/gameRes\"\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport default class rolePanel extends cc.Component {\r\n\r\n    @property(sp.Skeleton)\r\n    contraShow: sp.Skeleton = null;\r\n    @property(cc.Node)\r\n    contraNode: cc.Node = null;\r\n    @property(cc.Node)\r\n    roleInfoNode: cc.Node = null;\r\n    @property(cc.Node)\r\n    heroItem: cc.Node = null;\r\n    @property(cc.Node)\r\n    weaponItem: cc.Node = null;\r\n    @property(cc.SpriteAtlas)\r\n    heroSPA: cc.SpriteAtlas = null;\r\n\r\n\r\n    public roleAniName:any=null;\r\n    public roleHealthValue:any=null;\r\n    public roleWeaponName:any=null;\r\n    private heros: any[] = null;\r\n    private weapons: any[] = null;\r\n    onLoad() {\r\n        this.heros = playerRes.heroNames;\r\n        this.weapons = playerRes.contraGunName;\r\n        \r\n        this.roleAniName=this.heros[0]\r\n        this.roleWeaponName=this.weapons[0]\r\n\r\n        this.initHerosList();\r\n        this.initWeaponList();\r\n        this.initRoleShow(this.roleAniName);\r\n    }\r\n\r\n    /**\r\n     * 初始化英雄列表\r\n     */\r\n    initHerosList() {\r\n        let choiceHeroNode = this.node.getChildByName('choiceHero');\r\n        cc.find(\"view/content\", choiceHeroNode).active = true;\r\n\r\n        let from_pos = cc.v2(cc.winSize.width / 2, choiceHeroNode.getPosition().y);\r\n        let to_pos = cc.v2(0, choiceHeroNode.getPosition().y);\r\n        choiceHeroNode.position = from_pos;\r\n        choiceHeroNode.stopAllActions();\r\n        choiceHeroNode.runAction(cc.moveTo(0.5, to_pos));\r\n\r\n        for (let index = 0; index < this.heros.length; index++) {\r\n            let _item = cc.instantiate(this.heroItem);\r\n\r\n            if (index == 0) {\r\n                _item.getComponent(cc.Toggle).isChecked = true;\r\n            }\r\n\r\n            _item.getChildByName('headAltar').getComponent(cc.Sprite).spriteFrame = this.heroSPA.getSpriteFrame('head_' + this.heros[index]);\r\n            _item.getChildByName('name').getComponent(cc.Label).string = this.heros[index];\r\n            _item.active = true;\r\n            _item.getComponent(cc.Button).clickEvents[0].customEventData = this.heros[index];\r\n            //cc.log(_item.getComponent(cc.Button))\r\n            _item.parent = cc.find(\"choiceHero/view/content\", this.node);\r\n        }\r\n\r\n    }\r\n\r\n    /**\r\n    * 初始化武器列表\r\n    */\r\n    initWeaponList() {\r\n        let choiceWeaponNode = this.node.getChildByName('choiceWeapon');\r\n        cc.find(\"view/content\", choiceWeaponNode).active = true;\r\n\r\n        let from_pos = cc.v2(-cc.winSize.width / 2, choiceWeaponNode.getPosition().y);\r\n        let to_pos = cc.v2(0, choiceWeaponNode.getPosition().y);\r\n        choiceWeaponNode.position = from_pos;\r\n        choiceWeaponNode.stopAllActions();\r\n        choiceWeaponNode.runAction(cc.moveTo(0.5, to_pos));\r\n\r\n        for (let index = 0; index < this.weapons.length; index++) {\r\n            let _item = cc.instantiate(this.weaponItem);\r\n\r\n            if (index == 0) {\r\n                _item.getChildByName('default').active = true;\r\n                _item.getComponent(cc.Toggle).isChecked = true;\r\n            }\r\n\r\n            _item.getChildByName('weaponAltar').getComponent(cc.Sprite).spriteFrame = this.heroSPA.getSpriteFrame('gun_' + index);\r\n            _item.getChildByName('gunLevel').getComponent(cc.Sprite).spriteFrame = this.heroSPA.getSpriteFrame('gunLevel1');\r\n            _item.active = true;\r\n            _item.getComponent(cc.Button).clickEvents[0].customEventData = index.toString();\r\n            _item.parent = cc.find(\"choiceWeapon/view/content\", this.node);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 初始化英雄展示 默认第一个英雄\r\n     * @name 英雄名\r\n     */\r\n    initRoleShow(name) {\r\n        let path = playerRes[name].aniPath;\r\n        let self = this;\r\n        cc.loader.loadRes(path, sp.SkeletonData, function (err, _SkeletonData) {\r\n            if (err) {\r\n                cc.error(err.message || err);\r\n                return;\r\n            }\r\n            else {\r\n                //cc.log(_SkeletonData)\r\n                self.roleAniName=name\r\n                self.contraShow.skeletonData = _SkeletonData;\r\n                self.playApproachAni();\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * 英雄入场动画 从上方旋转一身后站着变成等候动画\r\n     */\r\n\r\n    playApproachAni() {\r\n        this.contraNode.setPosition(0, 0);\r\n        this.contraNode.setRotation(0);\r\n        this.contraNode.setScale(0.6)\r\n\r\n        let approachTime = 1;\r\n        this.contraShow.setMix('idle', 'roll2', 0.2);\r\n        this.node.getChildByName('light').active = false;\r\n\r\n        this.scheduleOnce(() => {\r\n            this.node.getChildByName('light').active = true;\r\n            this.isClickedApproachAni = true;\r\n            this.contraNode.setScale(1)\r\n        }, approachTime);\r\n\r\n        this.contraShow.setAnimation(0, 'roll2', true);\r\n        this.contraShow.addAnimation(0, 'idle', true, approachTime);\r\n\r\n\r\n        this.contraNode.runAction(cc.spawn(cc.rotateBy(approachTime, 360), cc.moveTo(approachTime, cc.v2(0, -290)).easing(cc.easeIn(approachTime))))\r\n        this.contraShow.setSkin(this.roleWeaponName);\r\n\r\n        this.updateRoleInfo()\r\n    }\r\n\r\n    updateRoleInfo(){\r\n        this.roleHealthValue=playerRes[this.roleAniName].health;\r\n        //cc.log(this.roleHealthValue)\r\n        this.roleInfoNode.getChildByName('name').getComponent(cc.Label).string='hero:'+this.roleAniName;\r\n        this.roleInfoNode.getChildByName('weapon').getComponent(cc.Label).string='weapon:'+this.roleWeaponName;\r\n        this.roleInfoNode.getChildByName('health').getComponent(cc.Label).string='health:'+this.roleHealthValue;\r\n    }\r\n\r\n    private isClickedApproachAni: boolean = true\r\n    clickSwithcHero(event, customEventData) {\r\n        //防止短时间多次点击\r\n        if (!this.isClickedApproachAni) return;\r\n        this.isClickedApproachAni = false;\r\n\r\n        this.initRoleShow(customEventData);\r\n    }\r\n\r\n    clickSwithcWeapon(event, customEventData) {\r\n        let gunName = 'gun' + customEventData;\r\n        this.contraShow.setSkin(gunName);\r\n        this.roleWeaponName=gunName\r\n        this.updateRoleInfo()\r\n    }\r\n    start() {\r\n\r\n    }\r\n    // update (dt) {}\r\n}\r\n"]}